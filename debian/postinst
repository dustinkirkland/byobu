#!/bin/sh -e

. /usr/share/debconf/confmodule
db_version 2.0

PKG="byobu"

db_get byobu/launch-by-default
if [ "$RET" = true ]; then
	ln -sf /usr/bin/$PKG-launcher /etc/profile.d/95-$PKG.sh
else
	rm -f /etc/profile.d/95-$PKG.sh
fi

# The target of the diversion somehow disappeared which will cause
# the divert removal to fail; we don't want that to happen
[ -e "/usr/bin/screen.real" ] && [ ! -e "/usr/bin/screen" ] && cp -a /usr/bin/screen.real /usr/bin/screen

# Notify users that they should reload their profile
DIR="/var/run/screen"
for d in $(ls "$DIR"); do
	touch "$DIR/$d/$PKG.reload-required"
	u=$(echo "$d" | sed "s:^S-::")
	chown $u "$DIR/$d/$PKG.reload-required"
	chmod 700 "$DIR/$d/$PKG.reload-required"
done

#DEBHELPER#
